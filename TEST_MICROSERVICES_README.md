# üß™ –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `test_microservices.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

- ‚úÖ API Gateway –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é
- ‚úÖ Users API (users-api)
- ‚úÖ Backend API (articles, comments)
- ‚úÖ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- ‚úÖ Data ownership pattern (user_id –±–µ–∑ FK)
- ‚úÖ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã (—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí —Å—Ç–∞—Ç—å—è ‚Üí –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
pip install requests
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `requirements.txt` (requests —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–º).

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã

```bash
docker-compose up -d
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç

```bash
python test_microservices.py
```

–ò–ª–∏ –Ω–∞ Linux/Mac:

```bash
chmod +x test_microservices.py
./test_microservices.py
```

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∫—Ä–∏–ø—Ç

### 1. API Gateway –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ `/api/users` –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ `users-api`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ `/api/articles` –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ `backend`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç health checks

### 2. Users API
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í—Ö–æ–¥ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

### 3. Backend API
- –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ —Å JWT —Ç–æ–∫–µ–Ω–æ–º
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å—Ç–∞—Ç–µ–π
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ –ø–æ slug
- –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ `author_id` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å—Ç–∞—Ç—å–µ

### 4. Data Ownership
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ `author_id` –≤ —Å—Ç–∞—Ç—å–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å `user_id` –∏–∑ —Ç–æ–∫–µ–Ω–∞
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ —Å–≤—è–∑—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ JWT, –∞ –Ω–µ —á–µ—Ä–µ–∑ FK

### 5. –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∫ —Å—Ç–∞—Ç—å–µ
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
============================================================
üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
============================================================

============================================================
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ API Gateway –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
============================================================

‚ÑπÔ∏è  –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ /api/users ‚Üí users-api
‚úÖ GET /api/users (–¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –≤ users-api) - Status: 200
‚úÖ –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤ users-api —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

‚ÑπÔ∏è  –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ /api/articles ‚Üí backend
‚úÖ GET /api/articles (–¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –≤ backend) - Status: 200
‚úÖ –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤ backend —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

...

============================================================
5. –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫
============================================================

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:

  ‚úÖ –ü–†–û–ô–î–ï–ù - Users Api
  ‚úÖ –ü–†–û–ô–î–ï–ù - Backend
  ‚úÖ –ü–†–û–ô–î–ï–ù - Api Gateway
  ‚úÖ –ü–†–û–ô–î–ï–ù - Authentication
  ‚úÖ –ü–†–û–ô–î–ï–ù - Data Ownership
  ‚úÖ –ü–†–û–ô–î–ï–ù - Full Flow

–ò—Ç–æ–≥–æ: 6/6 –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø—Ä–æ–π–¥–µ–Ω–æ

üéâ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã! –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–ï—Å–ª–∏ –≤–∞—à–∏ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –¥—Ä—É–≥–æ–º –∞–¥—Ä–µ—Å–µ, –∏–∑–º–µ–Ω–∏—Ç–µ `BASE_URL` –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞:

```python
BASE_URL = "http://localhost"  # –ò–ª–∏ "https://your-domain.com"
```

## Troubleshooting

### –û—à–∏–±–∫–∞: "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è"

**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã:
```bash
docker-compose ps
docker-compose up -d
```

### –û—à–∏–±–∫–∞: "Method Not Allowed"

**–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ users-api:
```bash
docker-compose restart users-api
```

### –û—à–∏–±–∫–∞: "JWT —Ç–æ–∫–µ–Ω –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `SECRET_KEY` –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤ –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö:
```bash
docker-compose exec backend env | grep SECRET_KEY
docker-compose exec users-api env | grep SECRET_KEY
```

### –û—à–∏–±–∫–∞: "Module 'requests' not found"

**–†–µ—à–µ–Ω–∏–µ**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ requests:
```bash
pip install requests
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

–°–∫—Ä–∏–ø—Ç –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- –ü—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è FK constraints
- –ü—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ë–î
- –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
- `psycopg2` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- `pytest` –¥–ª—è –±–æ–ª–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

